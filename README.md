## Project Title: Enhancement of Compositional Prompts and their fine-tuning using Blip-2

This folder contains the project submissions for CS500: Generative AI and LLM conducted in Fall-2024 at Information Technology University (ITU), Lahore.

## Submitted by:

- **Hassan Javaid (MSCS23001)**
- **Sauda Maryam (MSDS22025)**
- **Javeria Saeed (MSCS23010)**

## Course Instructor:

- **Dr. Mohsen Ali**

## Course TA:

- **Mr. Rohaan Mazoor**

## Project Introduction:

## Enhancement of Compositional Prompts Using BLIP-2

## Overview

This project focuses on enhancing the compositional prompts generated by a compositional learning model. The original prompts generated were in the format:  
`“A photo of acrylic sandal”`  
Here, **“acrylic”** is the attribute and **“sandal”** is the object.

To enhance these prompts, the similarity score was calculated using pre-defined [CLIP embeddings](https://openai.com/research/clip) of dataset attributes (e.g., color and material). The attribute combination with the highest similarity score was chosen, and an enhanced prompt was generated using a pre-defined format:  
`“A photo of acrylic sandal with white color and rubber material”`

---

## Dataset

The dataset used for this project is [UT-Zappos50K](https://vision.cs.utexas.edu/projects/finegrained/utzap50k/), a large shoe dataset that is publicly available on our [Kaggle website](https://www.kaggle.com/datasets/steer01/ut-zap50k-images).

---

## Model Details

### **Compositional Learning Model**

We used the [Troika](https://github.com/bighuang624/Troika/tree/master) model for compositional learning, which generates initial prompts by combining attributes and objects.

### **Fine-Tuning and Inference**

The [BLIP-2](https://github.com/salesforce/LAVIS/tree/main/projects/blip2) large language model (LLM) was used for:

1. **Training** with the enhanced prompts.
2. **Inference** to generate enriched captions.

---

## Implementation Highlights

- **Prompt Enhancement:** Calculated similarity scores with pre-defined CLIP embeddings for various attributes, selecting the combination with the highest score.
- **Enhanced Prompt Format:**  
  `“A photo of {attribute} {object} with {color} color and {material} material”`
- **Training Pipeline:** The [BLIP-2 LLM](https://github.com/salesforce/LAVIS/tree/main/projects/blip2) was fine-tuned using enhanced prompts created from the [UT-Zappos50K dataset](https://www.kaggle.com/datasets/steer01/ut-zap50k-images).

---

## References

- [UT-Zappos50K Dataset](https://www.kaggle.com/datasets/steer01/ut-zap50k-images)
- [Troika Model GitHub Repository](https://github.com/bighuang624/Troika/tree/master)
- [BLIP-2 LLM](https://github.com/salesforce/LAVIS/tree/main/projects/blip2)
- [CLIP by OpenAI](https://github.com/openai/CLIP)

---
